$(function(){var isWebkitBrowser=/webkit/i.test(navigator.userAgent);var notSupportDom=document.createElement("div");if(!isWebkitBrowser){$(notSupportDom).addClass("page-not-support").append('<div class="page-not-support-wrapper">'+"<p>当前浏览器不兼容，请使用谷歌浏览器或者其它浏览器的极速模式!</p>"+"<div>"+'<img src="/img/not-support/icon-chrome.png" />'+'<img src="/img/not-support/icon-360.png" />'+'<img src="/img/not-support/icon-safari.png" />'+"</div>"+"</div>");$("body").append(notSupportDom)}});String.prototype.replaceAll=function(s1,s2){return this.replace(new RegExp(s1,"gm"),s2)};String.prototype.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};String.prototype.ltrim=function(){return this.replace(/(^\s*)/g,"")};String.prototype.rtrim=function(){return this.replace(/(\s*$)/g,"")};Number.prototype.round=function(n){if(n==null)n=0;var t=Math.pow(10,n);return Math.round(this*t)/t};Date.prototype.format=function(fmt){if(fmt==undefined||fmt==null)fmt="yyyy-MM-dd";var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};var week={0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"};if(/(y+)/.test(fmt)){fmt=fmt.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}if(/(E+)/.test(fmt)){fmt=fmt.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"星期":"周":"")+week[this.getDay()+""])}for(var k in o){if(new RegExp("("+k+")").test(fmt)){fmt=fmt.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length))}}return fmt};var inc=new Object;inc.toJSON=function(obj,replacer,space){var cache=[];var json=JSON.stringify(obj,function(key,value){if(typeof value==="object"&&value!==null){if(cache.indexOf(value)!==-1){return}cache.push(value)}return replacer?replacer(key,value):value},space);cache=null;return json};inc.formatMoney=function(s,n){n=n>0&&n<=20?n:2;s=parseFloat((s+"").replace(/[^\d\.-]/g,"")).toFixed(n)+"";var l=s.split(".")[0].split("").reverse(),r=s.split(".")[1];t="";for(i=0;i<l.length;i++){t+=l[i]+((i+1)%3==0&&i+1!=l.length?",":"")}return t.split("").reverse().join("")+"."+r};inc.showNotice=function(msg){$(function(){if($("div#showSuccessInfo").length==0){var htmlobj='<div id="showSuccessInfo"  style="z-index:9999999;background-color: #BC3521;padding: 5px;position: fixed!important;position: absolute;color: #FFFFFF;"></div>';$(document.body).append(htmlobj)}$("div#showSuccessInfo").html(msg).show().css("top",document.documentElement.scrollTop+200).css("left",$(window).width()/2-30);var t=3e3;if(arguments[1])t=parseInt(arguments[1])*1e3;setTimeout(inc.closeNotice,t)})};inc.closeNotice=function(){$("div#showSuccessInfo").fadeOut(2e3)};inc.checkFileType=function(fileName,permitType){var l=fileName.length;var t=fileName.substring(fileName.lastIndexOf(".")+1,l);if(permitType.indexOf("|"+t+"|")<0){return false}else return true};inc.closeMainAbsoluteContainer=function(){var obj=$(".main-absolute-container");obj.parent().removeClass("open");obj.hide()};inc.bindCKEditorPasteImage=function(editor){editor.on("instanceReady",function(){this.document.on("paste",function(event){if(typeof FileReader=="undefined"){return}var items=(event.data.$.clipboardData||event.data.$.originalEvent.clipboardData).items;var blob;for(var i=0;i<items.length;i++){if(items[i].type.indexOf("image")===0){blob=items[i].getAsFile();break}}if(blob!==null&&blob!=undefined){var a=new FileReader;var dd;a.onload=function(){dd=this.result.substr(this.result.indexOf(",")+1);$.post("/site/pasteUpload/",{upload:dd},function(data){var json=eval("("+data+")");if(json.state==0){editor.insertHtml("<img src='"+json.data+"' />")}else{alert(json.data)}})};a.readAsDataURL(blob)}})})};inc.openWindow=function(obj){var o=$.extend({link:"#",height:500,width:960},obj||{});window.open(o.link,"newWindow"+Math.random(),"height="+o.height+",width="+o.width+",toolbar=no,menubar=no,scrollbars=yes, resizable=no,location=no, status=no")};inc.a=function(url){var obj=document.createElement("a");obj.href=url;obj.target="_blank";$("body").append(obj);obj.click();$(obj).remove()};inc.mainSearch=function(e){var f=$(e).parent("form");var p=f.find("#phone");if(p.val()==""){p.addClass("error");alert("请输入手机号或用户Id！");return}var reg=new RegExp("^[0-9]+$");if(!reg.test(p.val().trim())){p.addClass("error");alert("只能输入手机号或用户Id！");return}f.submit()};inc.setCookie=function(name,value,expireDays){var exDate=new Date;if(expireDays==undefined)expireDays=30;exDate.setDate(exDate.getDate()+expireDays);document.cookie=name+"="+escape(value)+(expireDays==null?"":";expires="+exDate.toGMTString())};inc.getCookie=function(name){if(document.cookie.length>0){c_start=document.cookie.indexOf(name+"=");if(c_start!=-1){c_start=c_start+name.length+1;c_end=document.cookie.indexOf(";",c_start);if(c_end==-1)c_end=document.cookie.length;return unescape(document.cookie.substring(c_start,c_end))}}return""};function alertModel(text,href){inc.setModal({icon:"info",title:text,ok:false,closeBtnText:"关闭",onClose:function(){if($.isFunction(href))href();else{if(href!=null)location.href=href}}})}function alertConfirmModel(text,func){inc.confirm({title:text,onOK:function(e){func(e)}})}function showFlowItem(id,flowId){openWindow({link:"/flow/flowItems/?t=1&search[finst.inst_id]="+id+"&search[finst.flow_id]="+flowId})}inc.showChart=function(option){var defaults={container:"#chartContainer",chartType:"spline",title:"",subTitle:"",yTitle:"",x:[],dataFormatter:function(){return this.y},yAxisFormatter:function(){return this.value},tooltipFormatter:function(){var s="<b>"+this.x+"</b>   "+this.series.name+": "+this.y;return s},series:[]};var o=$.extend(defaults,option);$(o.container).highcharts({chart:{type:o.chartType},title:{text:o.title},subtitle:{text:o.subTitle},xAxis:{categories:o.x},yAxis:{title:{text:o.yTitle},labels:{formatter:o.yAxisFormatter}},tooltip:{crosshairs:true,formatter:o.tooltipFormatter},plotOptions:{series:{dataLabels:{enabled:true,formatter:o.dataFormatter},cursor:"pointer",point:{events:{click:function(){if(typeof this.url!=undefined&&this.url){inc.a(this.url)}}}}}},series:o.series})};inc.dateAdd=function(date,strInterval,Number){var dtTmp=date;switch(strInterval){case"second":case"s":return new Date(Date.parse(dtTmp)+1e3*Number);case"minute":case"n":return new Date(Date.parse(dtTmp)+6e4*Number);case"hour":case"h":return new Date(Date.parse(dtTmp)+36e5*Number);case"day":case"d":return new Date(Date.parse(dtTmp)+864e5*Number);case"week":case"w":return new Date(Date.parse(dtTmp)+864e5*7*Number);case"month":case"m":var nextM=new Date(dtTmp.getFullYear(),dtTmp.getMonth()+Number+1,0);var max=nextM.getDate(),d=dtTmp.getDate();d=d>max?max:d;return new Date(dtTmp.getFullYear(),dtTmp.getMonth()+Number,d,dtTmp.getHours(),dtTmp.getMinutes(),dtTmp.getSeconds());case"year":case"y":return new Date(dtTmp.getFullYear()+Number,dtTmp.getMonth(),dtTmp.getDate(),dtTmp.getHours(),dtTmp.getMinutes(),dtTmp.getSeconds())}};inc.clearNullProperty=function(params){for(var p in params){if(params[p]==null||params[p]==undefined)delete params[p]}return params};inc.loadingIco='<i class="fa fa-spinner fa-pulse fa-fw" ></i>';inc.getPostData=function(view,filterParams){var data=ko.toJS(view);return inc.clearKOJSData(data,filterParams)};inc.clearKOJSData=function(obj,params){var defaults=["errors","save","saveBtnText","buttonText","actionState","tempSaveBtnText"];if(params)defaults=defaults.concat(params);for(var i=0;i<defaults.length;i++){delete obj[defaults[i]]}for(var p in obj){if(typeof obj[p]==="function")delete obj[p]}return obj};inc.objectToArray=function(obj){return Object.keys(obj).map(function(key){return obj[key]})};inc.mapObjectToArray=function(obj){return Object.keys(obj).map(function(key){return{id:key,name:obj[key]}})};inc.diffDays=function(start,end){var diff={years:0,months:0,days:0};var diffDays=0;var sDate=new Date(start);var eDate=new Date(end);var timeDiff=eDate-sDate;if(timeDiff>0){var years=eDate.getFullYear()-sDate.getFullYear();var months=eDate.getMonth()-sDate.getMonth();var days=eDate.getDate()-sDate.getDate();if(months<0){years--;months+=12}if(days<0){months=Math.max(0,diff.months-1);days+=30}diffDays=(years*12+months)*30+days}return diffDays};inc.moneyToChinese=function(money){var cnNums=new Array("零","壹","贰","叁","肆","伍","陆","柒","捌","玖");var cnIntRadice=new Array("","拾","佰","仟");var cnIntUnits=new Array("","万","亿","兆");var cnDecUnits=new Array("角","分","毫","厘");var cnIntLast="元";var maxNum=1e15;var IntegerNum;var DecimalNum;var ChineseStr="";var parts;if(money==""){return""}money=parseFloat(money);if(money>=maxNum){alert("超出最大处理数字");return""}if(money==0){ChineseStr=cnNums[0]+cnIntLast;return ChineseStr}money=money.toString();if(money.indexOf(".")==-1){IntegerNum=money;DecimalNum=""}else{parts=money.split(".");IntegerNum=parts[0];DecimalNum=parts[1].substr(0,4)}if(parseInt(IntegerNum,10)>0){zeroCount=0;IntLen=IntegerNum.length;for(i=0;i<IntLen;i++){n=IntegerNum.substr(i,1);p=IntLen-i-1;q=p/4;m=p%4;if(n=="0"){zeroCount++}else{if(zeroCount>0){ChineseStr+=cnNums[0]}zeroCount=0;ChineseStr+=cnNums[parseInt(n)]+cnIntRadice[m]}if(m==0&&zeroCount<4){ChineseStr+=cnIntUnits[q]}}ChineseStr+=cnIntLast}if(DecimalNum!=""){decLen=DecimalNum.length;for(i=0;i<decLen;i++){n=DecimalNum.substr(i,1);if(n!="0"){ChineseStr+=cnNums[Number(n)]+cnDecUnits[i]}}}if(ChineseStr==""){ChineseStr+=cnNums[0]+cnIntLast}return ChineseStr};inc.alert=function(msg){var defaults={id:"",icon:"info",title:msg,content:"",ok:false,okBtnText:"OK",closeBtnText:"关闭",close:true,onClose:null,onOK:null};inc.setModal(defaults)};inc.confirm=function(option){var defaults={id:"",icon:"question",title:"",content:"",ok:true,okBtnText:"确认",closeBtnText:"取消",close:true,onClose:null,onOK:null};var o=$.extend(defaults,option);inc.setModal(o)};inc.warning=function(msg){var defaults={icon:"warning",title:msg,ok:false,closeBtnText:"关闭",close:true,onClose:null,onOK:null};inc.setModal(defaults)};inc.error=function(msg){var defaults={icon:"error",title:msg,ok:false,closeBtnText:"关闭",close:true,onClose:null,onOK:null};inc.setModal(defaults)};inc.setModal=function(option){var defaults={id:"",icon:"",title:"",content:"",ok:true,okBtnText:"OK",closeBtnText:"关闭",close:true,onClose:null,onOK:null};var o=$.extend(defaults,option);var template='<div class="modal fade" tabindex="-1" role="dialog" >\n'+'    <div class="modal-dialog">\n'+'        <div class="modal-content" >\n'+'            <div class="modal-header">\n'+'                <button type="button" class="close" name="closeModel" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>\n'+'                <h4 class="modal-title">Modal title</h4>'+"            </div>"+'            <div class="modal-body">\n'+"            </div>"+'            <div class="modal-footer">\n'+"            </div>\n"+"        </div>\n"+"    </div>\n"+"</div>";var modal=$(template);if(o.id){modal.attr("id",o.id)}var icons={question:'<span class="glyphicon glyphicon-question-sign text-danger" aria-hidden="true"></span>',ok:'<span class="glyphicon glyphicon-ok-sign text-green" aria-hidden="true"></span>',error:'<span class="glyphicon glyphicon-remove-sign text-danger" aria-hidden="true"></span>',info:'<span class="glyphicon glyphicon-info-sign text-info" aria-hidden="true"></span>',warning:'<span class="glyphicon glyphicon-info-sign text-warning" aria-hidden="true"></span>'};var buttons={ok:'<button type="button" id="modalOkButton" name="modalOkButton" class="btn btn-primary" data-dismiss="modal">OK</button>',close:'<button type="button" id="modalCloseButton" name="closeModel" class="btn btn-default" data-dismiss="modal">关闭</button>'};var titleDom=modal.find(".modal-title");if(o.title){titleDom.html("&nbsp;"+o.title)}if(o.icon&&icons[o.icon])titleDom.prepend($(icons[o.icon]));if(titleDom.html()!="")titleDom.show();else titleDom.hide();var bodyDom=modal.find(".modal-body");if(o.content){bodyDom.html(o.content);bodyDom.show()}else bodyDom.hide();var footDom=modal.find(".modal-footer");if(o.close){var closeBtn=$(buttons["close"]).text(o.closeBtnText);footDom.append(closeBtn)}if(o.ok){var okBtn=$(buttons["ok"]).text(o.okBtnText);if($.isFunction(o.onOK)){okBtn.on("click",function(e){o.onOK(e)})}footDom.append(okBtn)}modal.on("hidden.bs.modal",function(e){if($.isFunction(o.onClose)){o.onClose(e)}modal.remove()});$(document.body).append(modal);modal.modal({backdrop:true,keyboard:false,show:true});return modal};inc.formatNumberToFixed=function(number,n){n=n||2;return parseFloat(number).toFixed(n)};inc.getNowDate=function(){return(new Date).format()};inc.getDateString=function(){var n=0;if(arguments[0]){n=arguments[0]}var d=new Date;d.setTime((new Date).getTime()+n*24*60*60*1e3);return d.toDateString()};inc.isMoney=function(money){if(parseFloat(money).toString()=="NaN"||parseFloat(money)<0){return false}return true};inc.isEmpty=function(val){return val==""||val==null||val==0||val==undefined};inc.toDecimal=function(val,scale){scale=scale||2;if(isNaN(parseFloat(val))){return 0}return Math.round(val*Math.pow(10,scale))/Math.pow(10,scale)};inc.get=function(name){if(typeof Storage!=="undefined"){return localStorage.getItem(name)}else{window.alert("Please use a modern browser to properly view this template!")}};inc.store=function(name,val){if(typeof Storage!=="undefined"){localStorage.setItem(name,val)}else{window.alert("Please use a modern browser to properly view this template!")}};inc.stopEnterDefault=function(event){event=window.event||event;if(event.keyCode==13){if(event&&event.preventDefault){event.preventDefault()}else{window.event.returnValue=false}return false}};